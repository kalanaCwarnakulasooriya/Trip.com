<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>All Destinations - Trip.com</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
  <link rel="stylesheet" href="css/darkIndex.css">
  <link rel="stylesheet" href="css/destination.css">
  <script src="https://unpkg.com/scrollreveal"></script>
</head>
<body>
<!-- Preloader -->
<div class="preloader">
  <div class="preloader-spinner"></div>
</div>
<!-- Header -->
<header class="header">
  <div class="container">
    <div class="header-inner">
      <div class="logo">
        <a href="home.html" class="logo-link">
          <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="3 11 22 2 13 21 11 13 3 11"/>
          </svg>
          <span class="logo-text">Trip</span> <span class="logo-sub">.com</span>
        </a>
      </div>
      <nav class="nav">
        <ul class="nav-list">
          <li><a href="home.html">Home</a></li>
          <li><a href="destination.html">Destinations</a></li>
          <li><a href="guides.html">Guides</a></li>
          <li><a href="universities.html">Universities</a></li>
          <li><a href="vehicle-rentals.html" class="active">Vehicle Rentals</a></li>
          <li><a href="feedBack.html">FeedBack</a></li>
        </ul>
      </nav>
      <div class="header-actions">
<!--        <button class="btn btn-outline" onclick="window.location.href= 'login.html'">Book Now</button>-->
        <button class="btn-logout" onclick="logout()">Logout</button>
        <button class="menu-toggle">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </div>
  </div>
</header>

<!-- Mobile Menu -->
<div class="mobile-menu">
  <div class="mobile-menu-inner">
    <div class="mobile-menu-footer">
      <div class="social-links">
        <a href="#" class="social-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
          </svg>
        </a>
        <a href="#" class="social-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
            <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
            <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
          </svg>
        </a>
        <a href="#" class="social-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
          </svg>
        </a>
      </div>
    </div>
  </div>
</div>

<!-- Main Content -->
<main>
  <!-- Page Header -->
  <section class="page-header" id="destinations">
    <div class="page-header-bg">
      <div class="page-header-overlay"></div>
    </div>
    <div class="container">
      <div class="page-header-content">
        <h1 class="page-title split-text">All Destinations</h1>
        <div class="breadcrumbs">
          <a href="home.html" class="breadcrumb-item">Home</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-item active">Destinations</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Destinations Section -->
  <section class="destinations-section">
    <div class="container">
      <!-- Destinations Filters -->
      <div class="destinations-filters">
        <div class="filter-wrapper">
          <div class="filter-group">
            <label for="category-filter">Category</label>
            <select id="category-filter" class="filter-select">
              <option value="all">All Categories</option>
              <option value="beach">Beach</option>
              <option value="city">City</option>
              <option value="mountain">Mountain</option>
              <option value="hiking">Hiking</option>
              <option value="historical">Historical</option>
              <option value="forest">Forest</option>
              <option value="waterfall">Waterfall</option>
              <option value="temple">Temple</option>
              <option value="farm">Farm</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="price-filter">Price Range</label>
            <select id="price-filter" class="filter-select">
              <option value="all">All Prices</option>
              <option value="budget">Budget</option>
              <option value="mid-range">Mid-Range</option>
              <option value="luxury">Luxury</option>
            </select>
          </div>
        </div>
        <div class="search-wrapper">
          <input type="text" id="destination-search" placeholder="Search destinations...">
          <button class="search-btn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
          </button>
        </div>
      </div>

      <!-- Destinations Grid -->
      <div class="destinations-grid" id="destinations-grid">
<!--        destinations will be displayed here dynamically-->
      </div>

      <!-- Pagination -->
      <div class="pagination">
        <a href="#" class="pagination-item active">1</a>
        <a href="#" class="pagination-item">2</a>
        <a href="#" class="pagination-item">3</a>
        <a href="#" class="pagination-item">4</a>
        <a href="#" class="pagination-next">
<!--          <span>Next</span>-->
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </a>
      </div>
    </div>
  </section>
</main>

<!-- Footer -->
<footer class="footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-column">
        <div class="footer-logo">
          <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
            <circle cx="12" cy="10" r="3"></circle>
          </svg>
          <span>Trip.com</span>
        </div>
        <p class="footer-description">Creating unforgettable travel experiences since 2010. Your journey begins with us.</p>
        <div class="footer-social">
          <a href="#" class="social-link">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
            </svg>
          </a>
          <a href="#" class="social-link">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
              <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
              <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
            </svg>
          </a>
          <a href="#" class="social-link">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
            </svg>
          </a>
        </div>
      </div>
      <div class="footer-column">
        <h3 class="footer-title">Quick Links</h3>
        <ul class="footer-links">
          <li><a href="#destinations">Home</a></li>
          <li><a href="home.html#packages">Packages</a></li>
          <li><a href="home.html#testimonials">Travelers</a></li>
          <li><a href="home.html#gallery">Gallery</a></li>
          <li><a href="home.html#contact">Contact</a></li>
        </ul>
      </div>
      <div class="footer-column">
        <h3 class="footer-title">Support</h3>
        <ul class="footer-links">
          <li><a href="#">FAQs</a></li>
          <li><a href="#">Terms & Conditions</a></li>
          <li><a href="#">Privacy Policy</a></li>
          <li><a href="#">Booking Information</a></li>
          <li><a href="#">Cancellation Policy</a></li>
        </ul>
      </div>
      <div class="footer-column">
        <h3 class="footer-title">Newsletter</h3>
        <p class="footer-newsletter-text">Subscribe to our newsletter for travel tips and exclusive offers</p>
        <div class="footer-newsletter">
          <input type="email" placeholder="Enter your email">
          <button class="btn btn-primary">Subscribe</button>
        </div>
        <p class="footer-newsletter-disclaimer">By subscribing, you agree to our Privacy Policy</p>
      </div>
    </div>
    <div class="footer-bottom">
      <p class="copyright">© <span id="currentYear"></span> Wanderlust Travel. All rights reserved.</p>
    </div>
  </div>
</footer>

<!-- Back to Top Button -->
<button class="back-to-top">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <polyline points="18 15 12 9 6 15"></polyline>
  </svg>
</button>

<!-- Scripts -->
<script src="js/index.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    async function loadDestinations() {
      const DEST_API_URL = "http://localhost:8080/api/allDestinations";
      const container = document.querySelector(".destinations-grid");
      if (!container) return;

      try {
        const res = await fetch(DEST_API_URL);
        const result = await res.json();

        if (res.ok && result.data?.length) {
          container.innerHTML = "";
          result.data.forEach((dest, i) => {
            const card = document.createElement("div");
            card.classList.add("destination-card");
            card.dataset.category = dest.category.join(',').toLowerCase();
            card.dataset.priceRange = dest.priceRange.toLowerCase();
            card.dataset.price = dest.price;

            card.innerHTML = `
          <div class="destination-image">
            <img src="${dest.imageUrl}" alt="${dest.title}">
            <div class="destination-overlay">
              <div class="destination-overlay-content">
                <a href="book-now.html" class="book-now">Book Now</a>
              </div>
            </div>
          </div>
          <div class="destination-content">
            <div class="destination-meta">
              <h3 class="destination-title">${dest.title}</h3>
              <span class="destination-rating">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                    </svg>
                ${dest.rating ?? "N/A"}
                </span>
            </div>
            <p class="destination-location">${dest.location} , Sri Lanka</p>
            <div class="destination-footer">
              <div class="destination-price">From <span>${dest.currency} ${dest.price.toLocaleString()}</span></div>
              <a href="#" class="destination-link">
                <span>Explore</span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                  <polyline points="12 5 19 12 12 19"></polyline>
                </svg>
              </a>
            </div>
          </div>
        `;
            container.appendChild(card);
          });

          // After rendering, define cards
          const destinationCards = Array.from(container.querySelectorAll('.destination-card'));

          function filterAndSearch() {
            const categoryValue = categoryFilter.value.toLowerCase();
            const priceValue = priceFilter.value.toLowerCase();
            const searchValue = searchInput.value.toLowerCase();

            destinationCards.forEach(card => {
              const title = card.querySelector('.destination-title').textContent.toLowerCase();
              const location = card.querySelector('.destination-location').textContent.toLowerCase();
              const category = card.dataset.category || '';
              const priceRange = card.dataset.priceRange || '';

              const matchesCategory = categoryValue === 'all' || category.includes(categoryValue);
              const matchesPrice = priceValue === 'all' || priceRange.includes(priceValue);
              const matchesSearch = title.includes(searchValue) || location.includes(searchValue);

              card.style.display = (matchesCategory && matchesPrice && matchesSearch) ? 'block' : 'none';
            });
          }

          categoryFilter.addEventListener('change', filterAndSearch);
          priceFilter.addEventListener('change', filterAndSearch);
          searchInput.addEventListener('input', filterAndSearch);

          filterAndSearch();
          if (window.AOS) AOS.refresh();
        }
      } catch (err) {
        console.error(err);
        container.innerHTML = "<p>Failed to load destinations.</p>";
      }
    }

    // --- INITIAL RENDER ---
    loadDestinations();
    filterAndSearch();

    // ===== Auth check (inside DOMContentLoaded) =====
    const token = getCookie("token");
    if (!token) {
      // toastr.warning("You must be logged in.", "Access Denied");
      setTimeout(() => window.location.href = "login.html", 1500);
    }
  });

  // ===== Cookie Helpers (GLOBAL scope) =====
  function getCookie(name) {
    const nameEQ = name + "=";
    const ca = document.cookie.split(';');
    for (let i = 0; i < ca.length; i++) {
      let c = ca[i].trim();
      if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
  }

  function deleteCookie(name) {
    document.cookie = name + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Lax;";
  }

  // ===== Logout (GLOBAL so button onclick works) =====
  function logout() {
    deleteCookie("token");
    deleteCookie("username");
    // toastr.info("Logged out successfully.", "Logout");
    setTimeout(() => window.location.href = "index.html", 1500);
  }


  // --- VARIABLES ---
  const destinationsGrid = document.querySelector('.destinations-grid');
  const destinationCards = Array.from(document.querySelectorAll('.destination-card'));
  const categoryFilter = document.getElementById('category-filter');
  const priceFilter = document.getElementById('price-filter');
  const searchInput = document.getElementById('destination-search');

  // --- FILTER & SEARCH FUNCTION ---
  function filterAndSearch() {
    const categoryValue = categoryFilter.value.toLowerCase();
    const priceValue = priceFilter.value.toLowerCase();
    const searchValue = searchInput.value.toLowerCase();

    destinationCards.forEach(card => {
      const title = card.querySelector('.destination-title').textContent.toLowerCase();
      const location = card.querySelector('.destination-location').textContent.toLowerCase();

      // Use data attributes for filtering
      const category = card.dataset.category ? card.dataset.category.toLowerCase() : '';
      const price = card.dataset.price ? card.dataset.price.toLowerCase() : '';

      const matchesCategory = categoryValue === 'all' || category.includes(categoryValue);
      const matchesPrice = priceValue === 'all' || price.includes(priceValue);
      const matchesSearch = title.includes(searchValue) || location.includes(searchValue);

      if (matchesCategory && matchesPrice && matchesSearch) {
        card.style.display = 'block';
      } else {
        card.style.display = 'none';
      }
    });
  }

  // --- EVENT LISTENERS ---
  categoryFilter.addEventListener('change', filterAndSearch);
  priceFilter.addEventListener('change', filterAndSearch);
  searchInput.addEventListener('input', filterAndSearch);


</script>
</body>
</html>